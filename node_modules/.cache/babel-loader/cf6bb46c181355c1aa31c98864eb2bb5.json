{"ast":null,"code":"import _defineProperty from\"/home/palak/portis-react-starter/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/home/palak/portis-react-starter/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/palak/portis-react-starter/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/palak/portis-react-starter/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/palak/portis-react-starter/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/palak/portis-react-starter/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/palak/portis-react-starter/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{web3,portis}from\"../services/web3\";import{abi}from\"../abi/Transaction.js\";var contractAddress='0x726F7341A0907709FfdEf583fDEa3d63eAF0E673';var TransactionContract=new web3.eth.Contract(abi,contractAddress);var SendTransferForm=/*#__PURE__*/function(_Component){_inherits(SendTransferForm,_Component);var _super=_createSuper(SendTransferForm);function SendTransferForm(props){var _this;_classCallCheck(this,SendTransferForm);_this=_super.call(this,props);_this.state={senderAddress:'',receiverAddress:'',amount:1,senderBalance:0,receiverBalance:0,message:''};return _this;}_createClass(SendTransferForm,[{key:\"activateMenu\",value:function activateMenu(){portis.showPortis();}},{key:\"sendTransfer\",value:function(){var _sendTransfer=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this2=this;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(this.state.senderBalance>0)){_context.next=11;break;}_context.prev=1;console.log(\"try started\");_context.next=5;return TransactionContract.methods.transferFunds(this.state.receiverAddress).send({from:this.state.senderAddress,value:web3.utils.toWei(this.state.amount.toString(),'ether')},function(error,result){if(error){console.log(\"I will give error\");_this2.setState({message:'error:'+error.message});}else{_this2.setState({message:'transaction hash:'+result});}});case 5:_context.next=11;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](1);console.log(\"try failed\");this.setState({message:'the transfer has failed'});case 11:case\"end\":return _context.stop();}}},_callee,this,[[1,7]]);}));function sendTransfer(){return _sendTransfer.apply(this,arguments);}return sendTransfer;}()},{key:\"checkBalance\",value:function(){var _checkBalance=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var senderBalance,receiverBalance,message;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:senderBalance=0;receiverBalance=0;message='';if(!web3.utils.isAddress(this.state.senderAddress)){_context2.next=11;break;}_context2.t0=web3.utils;_context2.next=7;return web3.eth.getBalance(this.state.senderAddress);case 7:_context2.t1=_context2.sent;senderBalance=_context2.t0.fromWei.call(_context2.t0,_context2.t1);_context2.next=12;break;case 11:message='Error: Incorrect etherum address for the sender';case 12:if(!this.state.receiverAddress){_context2.next=22;break;}if(!web3.utils.isAddress(this.state.receiverAddress)){_context2.next=21;break;}_context2.t2=web3.utils;_context2.next=17;return web3.eth.getBalance(this.state.receiverAddress);case 17:_context2.t3=_context2.sent;receiverBalance=_context2.t2.fromWei.call(_context2.t2,_context2.t3);_context2.next=22;break;case 21:message='Error: Incoreect etherum address for the receiver';case 22:this.setState({senderBalance:senderBalance,receiverBalance:receiverBalance,message:message});case 23:case\"end\":return _context2.stop();}}},_callee2,this);}));function checkBalance(){return _checkBalance.apply(this,arguments);}return checkBalance;}()},{key:\"onChange\",value:function onChange(e){this.setState(_defineProperty({},e.target.name,e.target.value));}},{key:\"componentDidMount\",value:function componentDidMount(){var _this3=this;portis.onLogin(function(senderAddress){_this3.setState({senderAddress:senderAddress});_this3.checkBalance();});portis.onActiveWalletChanged(function(senderAddress){_this3.setState({senderAddress:senderAddress});_this3.checkBalance();});}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"nine columns smallTop\"},this.state.message&&/*#__PURE__*/React.createElement(\"b\",null,this.state.message)),/*#__PURE__*/React.createElement(\"div\",{className:\"three columns u-pull-right\"},/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"u-full-width\",onClick:this.activateMenu},\"Portis Menu\"))),/*#__PURE__*/React.createElement(\"form\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"row smallTop\"},/*#__PURE__*/React.createElement(\"div\",{className:\"six columns\"},/*#__PURE__*/React.createElement(\"label\",null,\"Sender Address\"),/*#__PURE__*/React.createElement(\"input\",{name:\"senderAddress\",value:this.state.senderAddress,type:\"text\",className:\"u-full-width\",placeholder:\"Loading...\",disabled:true})),/*#__PURE__*/React.createElement(\"div\",{className:\"six columns\"},/*#__PURE__*/React.createElement(\"label\",null,\"Receiver Address\"),/*#__PURE__*/React.createElement(\"input\",{name:\"receiverAddress\",value:this.state.receiverAddress,type:\"text\",className:\"u-full-width\",placeholder:\"Enter the receiver address\",required:true,onChange:this.onChange.bind(this)}))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"six columns\"},/*#__PURE__*/React.createElement(\"label\",null,\"Amount\"),/*#__PURE__*/React.createElement(\"input\",{name:\"amount\",value:this.state.amount,type:\"text\",className:\"u-full-width\",placeholder:\"Amount to send\",required:true,onChange:this.onChange.bind(this)})),/*#__PURE__*/React.createElement(\"div\",{className:\"three columns\"},/*#__PURE__*/React.createElement(\"label\",null,\"Sender Balance\"),/*#__PURE__*/React.createElement(\"p\",null,this.state.senderBalance,\" ETH\")),/*#__PURE__*/React.createElement(\"div\",{className:\"three columns\"},/*#__PURE__*/React.createElement(\"label\",null,\"Receiver Balance\"),/*#__PURE__*/React.createElement(\"p\",null,this.state.receiverBalance,\" ETH\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"six columns\"},/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"button-primary u-full-width\",disabled:!this.state.receiverAddress,onClick:this.sendTransfer.bind(this)},\"Transfer\")),/*#__PURE__*/React.createElement(\"div\",{className:\"six columns\"},/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"u-full-width\",onClick:this.checkBalance.bind(this)},\"Check Balance\")))));}}]);return SendTransferForm;}(Component);export{SendTransferForm as default};","map":{"version":3,"sources":["/home/palak/portis-react-starter/src/components/SendTransferForm.js"],"names":["React","Component","web3","portis","abi","contractAddress","TransactionContract","eth","Contract","SendTransferForm","props","state","senderAddress","receiverAddress","amount","senderBalance","receiverBalance","message","showPortis","console","log","methods","transferFunds","send","from","value","utils","toWei","toString","error","result","setState","isAddress","getBalance","fromWei","e","target","name","onLogin","checkBalance","onActiveWalletChanged","activateMenu","onChange","bind","sendTransfer"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport {web3,portis} from \"../services/web3\";\n\nimport {abi} from \"../abi/Transaction.js\";\n\nconst contractAddress = '0x726F7341A0907709FfdEf583fDEa3d63eAF0E673';\nconst TransactionContract = new web3.eth.Contract(abi, contractAddress); \n\nexport default class SendTransferForm extends Component {\n   constructor(props) {\n      super(props);\n      this.state = {\n         senderAddress: '',\n         receiverAddress: '',\n         amount: 1,\n         senderBalance: 0,\n         receiverBalance: 0,\n         message: '',\n      };\n   }\n\n   activateMenu(){\n      portis.showPortis();\n   }\n\n   async sendTransfer(){\n      if(this.state.senderBalance>0){\n         try{\n            console.log(\"try started\");\n            await TransactionContract.methods\n               .transferFunds(this.state.receiverAddress)\n               .send({\n                  from:this.state.senderAddress,\n                  value:web3.utils.toWei(\n                     this.state.amount.toString(),\n                     'ether'\n                  )\n               },\n               (error,result)=>{\n                  if(error){\n                     console.log(\"I will give error\");\n                     this.setState({message:'error:'+error.message});\n                  }\n                  else{\n                     this.setState({message:'transaction hash:'+result});\n                  }\n               }\n               );\n            }\n         catch(error){\n            console.log(\"try failed\");\n            this.setState({message:'the transfer has failed'});\n         }\n         \n      }\n   }\n\n   async checkBalance(){\n      let senderBalance=0;\n      let receiverBalance=0;\n      let message='';\n\n      if(web3.utils.isAddress(this.state.senderAddress)) {\n            senderBalance=web3.utils.fromWei(\n                  await web3.eth.getBalance(this.state.senderAddress)\n            );\n      }\n      else{\n            message='Error: Incorrect etherum address for the sender';\n      }\n\n      if(this.state.receiverAddress){\n            if(web3.utils.isAddress(this.state.receiverAddress)){\n                  receiverBalance=web3.utils.fromWei(\n                        await web3.eth.getBalance(this.state.receiverAddress)\n                  );\n            }\n            else{\n                  message = 'Error: Incoreect etherum address for the receiver';\n            }\n      }\n      this.setState({senderBalance,receiverBalance,message});\n}\n\n   onChange(e) {\n      this.setState({ [e.target.name]: e.target.value });\n   }\n\n   componentDidMount() {\n      portis.onLogin((senderAddress)=>{\n         this.setState({senderAddress});\n         this.checkBalance();\n      })\n\n      portis.onActiveWalletChanged((senderAddress)=>{\n         this.setState({senderAddress});\n         this.checkBalance();\n      })\n   }\n\n   render() {\n      return (\n         <div>\n            <div className=\"row\">\n               <div className=\"nine columns smallTop\">\n                  {this.state.message && <b>{this.state.message}</b>}\n               </div>\n               <div className=\"three columns u-pull-right\">\n                  <button type=\"button\" className=\"u-full-width\" onClick={this.activateMenu}>\n                     Portis Menu\n                  </button>\n               </div>\n            </div>\n\n            <form>\n               <div className=\"row smallTop\">\n                  <div className=\"six columns\">\n                     <label>Sender Address</label>\n                     <input\n                        name=\"senderAddress\"\n                        value={this.state.senderAddress}\n                        type=\"text\"\n                        className=\"u-full-width\"\n                        placeholder=\"Loading...\"\n                        disabled\n                     />\n                  </div>\n                  <div className=\"six columns\">\n                     <label>Receiver Address</label>\n                     <input\n                        name=\"receiverAddress\"\n                        value={this.state.receiverAddress}\n                        type=\"text\"\n                        className=\"u-full-width\"\n                        placeholder=\"Enter the receiver address\"\n                        required\n                        onChange={this.onChange.bind(this)}\n                     />\n                  </div>\n               </div>\n               <div className=\"row\">\n                  <div className=\"six columns\">\n                     <label>Amount</label>\n                     <input\n                        name=\"amount\"\n                        value={this.state.amount}\n                        type=\"text\"\n                        className=\"u-full-width\"\n                        placeholder=\"Amount to send\"\n                        required\n                        onChange={this.onChange.bind(this)}\n                     />\n                  </div>\n                  <div className=\"three columns\">\n                     <label>Sender Balance</label>\n                     <p>{this.state.senderBalance} ETH</p>\n                  </div>\n                  <div className=\"three columns\">\n                     <label>Receiver Balance</label>\n                     <p>{this.state.receiverBalance} ETH</p>\n                  </div>\n               </div>\n               <div className=\"row\">\n                  <div className=\"six columns\">\n                     <button\n                        type=\"button\"\n                        className=\"button-primary u-full-width\"\n                        disabled={!this.state.receiverAddress}\n                        onClick={this.sendTransfer.bind(this)}\n                     >\n                        Transfer\n                     </button>\n                  </div>\n                  <div className=\"six columns\">\n                     <button type=\"button\" className=\"u-full-width\" onClick={this.checkBalance.bind(this)}>\n                        Check Balance\n                     </button>\n                  </div>\n               </div>\n            </form>\n         </div>\n      );\n   }\n}\n"]},"metadata":{},"sourceType":"module"}